webpackJsonp([1],{"3vTJ":function(t,e){},FXkv:function(t,e,a){var s=a("zNUS");s.setup({timeout:1e3}),s.mock(new RegExp("/login"),"post",function(t){return"username=bing&password=password"==t.body?{statusCode:200,token:s.Random.natural()}:{statusCode:401}}),s.mock(new RegExp("/logout"),"get",function(){return{statusCode:200}}),s.mock(new RegExp("/register"),"post",function(t){return{statusCode:200}}),s.mock(new RegExp("/userinfo"),"post",function(t){return{statusCode:200,avatar:"./static/img/avatar-bing.png"}}),s.mock(new RegExp("/diary"),"post",function(t){return s.mock({statusCode:200,username:"bing",count:50,"diaries|3-12":[{"id|1356998400000-1511525072484":1,"date|1356998400000-1511525072484":1,"text|2-50":"这是一条日记","mood|1":["开心","平静","伤心"],"moodColor|1":["#11A5F7","#A3A9A0","#DD2C00"],"weather|1":["晴","阴","雨","风","雪"]}],dates:{months:[1,3,6,8,9,10,11,12],years:[2017,2016,2015,2014]}})}),s.mock(new RegExp("/diary/*"),"post",function(t){return{statusCode:200,diary:{"id|1356998400000-1511525072484":1,"date|1356998400000-1511525072484":1,"text|2-50":"这是一条日记","mood|1":["开心","平静","伤心"],"moodColor|1":["#11A5F7","#A3A9A0","#DD2C00"],"weather|1":["晴","阴","雨","风","雪"],"img|0-3":["./static/img/diary-img.jpg"]}}}),s.mock(new RegExp("/diary/*"),"delete",function(t){return{statusCode:200}}),s.mock(new RegExp("/diary/add"),"post",function(t){return{statusCode:200}})},"Fqd/":function(t,e,a){t.exports=a.p+"static/img/fontawesome-webfont.912ec66.svg"},H1ih:function(t,e){},IMLV:function(t,e,a){t.exports=a.p+"static/fonts/fontawesome-webfont.b06871f.ttf"},NHnr:function(t,e,a){"use strict";function s(t){a("Q4uO")}function r(t){a("XBpM")}function n(t){a("WIEj")}function i(t){a("lnU4")}function o(t){a("3vTJ")}function d(t){a("ulV+")}function u(t){a("H1ih")}Object.defineProperty(e,"__esModule",{value:!0});var c=a("7+uW"),l={name:"app"},p=function(){var t=this,e=t.$createElement;return(t._self._c||e)("router-view")},f=[],v={render:p,staticRenderFns:f},m=v,g=a("VU/8"),w=s,h=g(l,m,!1,w,null,null),y=h.exports,_=a("/ocq"),C={domain:""},k={name:"Login",data:function(){return{username:"",password:"",userErr:!0,passwordErr:!0,userErrMsg:"",passwordErrMsg:"",submitDisabled:!0}},watch:{username:function(t){t.length<4?(this.userErrMsg="用户名不能小于4个字符",this.userErr=!0):(this.userErrMsg="",this.userErr=!1)},password:function(t){t.length<6?(this.passwordErrMsg="密码不能小于6个字符",this.passwordErr=!0):(this.passwordErrMsg="",this.passwordErr=!1)},inputValidated:function(t){1==t&&(this.submitDisabled=!1)}},computed:{inputValidated:function(){return!(this.userErr||this.passwordErr)}},methods:{login:function(){var t=this.username.replace(/\s/g,""),e=this.password.replace(/\s/g,""),a=new XMLHttpRequest;a.open("post",C.domain+"/login",!1),a.send("username="+t+"&password="+e);var s=JSON.parse(a.responseText);return"200"==s.statusCode?(window.sessionStorage.setItem("logged-in",!0),window.sessionStorage.setItem("username",t),window.sessionStorage.setItem("token",s.token),this.$router.replace("/diary")):"401"==s.statusCode&&(this.passwordErrMsg="用户名或密码错误"),!0}}},b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"login"}},[a("div",{attrs:{id:"form-container"}},[a("h2",[t._v("登录")]),t._v(" "),a("div",{staticClass:"form-item"},[a("div",{staticClass:"form-item-content"},[a("i",{staticClass:"fa fa-user fa-fw"}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{type:"text",placeholder:"用户名",autofocus:""},domProps:{value:t.username},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.login(e)},input:function(e){e.target.composing||(t.username=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-message"},[t._v(t._s(t.userErrMsg))])]),t._v(" "),a("div",{staticClass:"form-item"},[a("div",{staticClass:"form-item-content"},[a("i",{staticClass:"fa fa-lock fa-fw"}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"密码"},domProps:{value:t.password},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.login(e)},input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-message"},[t._v(t._s(t.passwordErrMsg))])]),t._v(" "),a("div",{staticClass:"form-submit"},[a("input",{attrs:{type:"submit",value:"登录",disabled:t.submitDisabled},on:{click:function(e){e.preventDefault(),t.login(e)}}})]),t._v(" "),a("router-link",{staticClass:"register",attrs:{to:"/register"}},[t._v("注册账号")])],1)])},E=[],D={render:b,staticRenderFns:E},x=D,M=a("VU/8"),S=r,R=M(k,x,!1,S,null,null),A=R.exports,N={name:"Register",data:function(){return{username:"",password:"",repassword:"",userErr:!0,passwordErr:!0,repasswordErr:!0,userErrMsg:"",passwordErrMsg:"",repasswordErrMsg:"",submitDisabled:!0}},watch:{username:function(t){t.length<4?(this.userErrMsg="用户名不能小于4个字符",this.userErr=!0):(this.userErrMsg="",this.userErr=!1)},password:function(t){t.length<6?(this.passwordErrMsg="密码不能小于6个字符",this.passwordErr=!0):(this.passwordErrMsg="",this.passwordErr=!1)},repassword:function(t){t!=this.password?(this.repasswordErrMsg="两次密码输入不一致",this.repasswordErr=!0):(this.repasswordErrMsg="",this.repasswordErr=!1)},inputValidated:function(t){1==t&&(this.submitDisabled=!1)}},computed:{inputValidated:function(){return!(this.userErr||this.passwordErr||this.repasswordErr)}},methods:{register:function(){var t=this.username.replace(/\s/g,""),e=this.password.replace(/\s/g,""),a=this.repassword.replace(/\s/g,""),s=new XMLHttpRequest;return s.open("post",C.domain+"/register",!1),s.send("username="+t+"&password="+e+"&repassword="+a),"200"==JSON.parse(s.responseText).statusCode&&(alert("注册成功"),this.$router.push("/login")),!0}}},I=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"register"}},[a("div",{attrs:{id:"form-container"}},[a("h2",[t._v("注册")]),t._v(" "),a("div",{staticClass:"form-item"},[a("div",{staticClass:"form-item-content"},[a("i",{staticClass:"fa fa-user fa-fw"}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{type:"text",placeholder:"用户名",autofocus:""},domProps:{value:t.username},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.register(e)},input:function(e){e.target.composing||(t.username=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-message"},[t._v(t._s(t.userErrMsg))])]),t._v(" "),a("div",{staticClass:"form-item"},[a("div",{staticClass:"form-item-content"},[a("i",{staticClass:"fa fa-lock fa-fw"}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"密码"},domProps:{value:t.password},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.register(e)},input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-message"},[t._v(t._s(t.passwordErrMsg))])]),t._v(" "),a("div",{staticClass:"form-item"},[a("div",{staticClass:"form-item-content"},[a("i",{staticClass:"fa fa-lock fa-fw"}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.repassword,expression:"repassword"}],attrs:{type:"password",placeholder:"确认密码"},domProps:{value:t.repassword},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.register(e)},input:function(e){e.target.composing||(t.repassword=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-message"},[t._v(t._s(t.repasswordErrMsg))])]),t._v(" "),a("div",{staticClass:"form-submit"},[a("input",{attrs:{type:"submit",value:"注册",disabled:t.submitDisabled},on:{click:function(e){e.preventDefault(),t.register(e)}}})]),t._v(" "),a("router-link",{staticClass:"login",attrs:{to:"/login"}},[t._v("登录")])],1)])},P=[],F={render:I,staticRenderFns:P},O=F,$=a("VU/8"),V=n,H=$(N,O,!1,V,null,null),L=H.exports,U={name:"NavBar",props:["currentPage"],data:function(){return{avatar:this.getAvatar(this.username)}},computed:{username:function(){return window.sessionStorage.getItem("username")}},methods:{getAvatar:function(t){var e=new XMLHttpRequest;e.open("post",C.domain+"/userinfo",!1),e.send("username="+t);var a=JSON.parse(e.responseText);return"200"==a.statusCode?a.avatar:"./static/img/avatar-default.png"},logout:function(){var t=new XMLHttpRequest;t.open("get",C.domain+"/logout",!1),t.send(),"200"==JSON.parse(t.responseText).statusCode&&(window.sessionStorage.setItem("logged-in",!1),window.sessionStorage.setItem("username",""),window.sessionStorage.setItem("token",""),this.$router.replace("/login"))}}},X=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"nav-bar"}},[t._m(0,!1,!1),t._v(" "),a("div",{staticClass:"user-info"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:t.avatar,alt:t.username}})]),t._v(" "),a("div",{staticClass:"username"},[a("span",[t._v(t._s(t.username))])])]),t._v(" "),a("div",{attrs:{id:"nav-list"}},[a("router-link",{staticClass:"nav-item",class:{"current-page":"diary"==t.currentPage},attrs:{to:"/diary"}},[a("i",{staticClass:"fa fa-book fa-fw"}),t._v(" "),a("span",{staticClass:"text"},[t._v("diary")])]),t._v(" "),a("router-link",{staticClass:"nav-item",class:{"current-page":"calendar"==t.currentPage},attrs:{to:"/calendar"}},[a("i",{staticClass:"fa fa-calendar fa-fw"}),t._v(" "),a("span",{staticClass:"text"},[t._v("calendar")])]),t._v(" "),a("router-link",{staticClass:"nav-item",class:{"current-page":"overview"==t.currentPage},attrs:{to:"/overview"}},[a("i",{staticClass:"fa fa-info fa-fw"}),t._v(" "),a("span",{staticClass:"text"},[t._v("overview")])])],1),t._v(" "),a("div",{staticClass:"nav-item logout",on:{click:t.logout}},[a("i",{staticClass:"fa fa-sign-out fa-fw"}),t._v(" "),a("span",{staticClass:"text"},[t._v("logout")])])])},T=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title"},[a("h3",[t._v("日记")])])}],Y={render:X,staticRenderFns:T},q=Y,J=a("VU/8"),j=i,B=J(U,q,!1,j,"data-v-31aa96d9",null),W=B.exports,Q={name:"Diary",data:function(){return{diary:this.getDiary(),yearSelected:"all",monSelected:"all",hideDiary:!1,showAddDiary:!1,newDiary:"",newDiaryMood:"happy"}},beforeCreate:function(){"true"!=window.sessionStorage.getItem("logged-in")&&this.$router.replace("/login")},components:{"nav-bar":W},watch:{yearSelected:function(t){this.diary=this.getDiary("year="+t+"&month="+this.monSelected)},monSelected:function(t){this.diary=this.getDiary("year="+this.yearSelected+"&month="+t)}},computed:{yearOption:function(){return this.diary.dates.years},monthOption:function(){return this.diary.dates.months},addDiaryBorderLeft:function(){var t="";switch(this.newDiaryMood){case"happy":t="#11A5F7";break;case"calm":t="#A3A9A0";break;case"sad":t="#DD2C00"}return{"border-left":"5px solid "+t}}},methods:{getDiary:function(t){var e=new XMLHttpRequest,a=window.sessionStorage.getItem("username"),s=window.sessionStorage.getItem("token");e.open("post",C.domin+"/diary",!1),e.send(t+"&username="+a+"&token="+s);var r=JSON.parse(e.responseText);if("401"==r.statusCode)this.$router.replace("/login");else if("200"==r.statusCode)return r},parseDate:function(t){var e=new Date(parseInt(t)),a=e.getFullYear(),s=e.getMonth()+1,r=e.getDate();return s<10&&(s="0"+s),r<10&&(r="0"+r),a+"/"+s+"/"+r},parseTime:function(t){var e=new Date(parseInt(t)),a=e.getHours(),s=e.getMinutes();return a<10&&(a="0"+a),s<10&&(s="0"+s),a+":"+s},hide:function(){this.hideDiary=!this.hideDiary},deleteDiary:function(t){var e=new XMLHttpRequest;e.open("delete",C.domin+"/diary/"+t.id),e.send(),this.diary.diaries.splice(this.diary.diaries.indexOf(t),1)},newDiarySubmit:function(){if(0!=this.newDiary.length){var t=new XMLHttpRequest;t.open("post",C.domain+"/diary/add",!1),t.send(""),alert("添加日记成功"),this.newDiary="",this.showAddDiary=!1}}}},z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"diary"}},[a("nav-bar",{attrs:{currentPage:"diary"}}),t._v(" "),a("div",{attrs:{id:"diary-container"}},[a("div",{staticClass:"diary-top"},[a("div",{staticClass:"diary-filter"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.yearSelected,expression:"yearSelected"}],attrs:{name:"diary-year"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.yearSelected=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"all"}},[t._v("*")]),t._v(" "),t._l(t.yearOption,function(e){return a("option",{key:e,domProps:{value:e}},[t._v(t._s(e))])})],2)]),t._v(" "),a("div",{staticClass:"diary-filter"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.monSelected,expression:"monSelected"}],attrs:{name:"diary-month"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.monSelected=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"all"}},[t._v("*")]),t._v(" "),t._l(t.monthOption,function(e){return a("option",{key:e,domProps:{value:e}},[t._v(t._s(e+" 月"))])})],2)]),t._v(" "),a("div",{staticClass:"btn btn-hide-diary",on:{click:t.hide}},[a("i",{staticClass:"fa fa-eye fa-fw",class:t.hideDiary?"fa-eye-slash":"fa-eye"})]),t._v(" "),a("div",{staticClass:"btn btn-add-diary",on:{click:function(e){t.showAddDiary=!t.showAddDiary}}},[a("i",{staticClass:"fa fa-plus fa-fw"})])]),t._v(" "),a("transition-group",{staticClass:"diary-list",attrs:{tag:"div",name:"diary-list"}},[t.showAddDiary?a("div",{key:"textarea",staticClass:"diary-item",style:t.addDiaryBorderLeft},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newDiary,expression:"newDiary"}],staticClass:"diary-text",attrs:{id:"add-diary-textarea",placeholder:"添加新日记"},domProps:{value:t.newDiary},on:{input:function(e){e.target.composing||(t.newDiary=e.target.value)}}}),t._v(" "),a("div",{staticClass:"diary-footer"},[a("span",[t._v("mood: ")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.newDiaryMood,expression:"newDiaryMood"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.newDiaryMood=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"happy"}},[t._v("happy")]),t._v(" "),a("option",{attrs:{value:"calm"}},[t._v("calm")]),t._v(" "),a("option",{attrs:{value:"sad"}},[t._v("sad")])]),t._v(" "),a("i",{staticClass:"fa fa-check fa-fw btn-delete",on:{click:t.newDiarySubmit}})])]):t._e(),t._v(" "),t._l(t.diary.diaries,function(e){return a("div",{key:e.id,staticClass:"diary-item",style:{"border-left":"5px solid "+e.moodColor}},[a("div",{staticClass:"diary-text",class:{"hide-diary":t.hideDiary}},[t._v(t._s(e.text))]),t._v(" "),a("div",{staticClass:"diary-footer"},[a("span",{staticClass:"diary-date"},[t._v(t._s(t.parseDate(e.date)))]),t._v(" "),a("span",{staticClass:"diary-time"},[t._v(t._s(t.parseTime(e.date)))]),t._v(" "),a("i",{staticClass:"fa fa-close fa-fw btn-delete",on:{click:function(a){t.deleteDiary(e)}}})])])})],2)],1)],1)},G=[],K={render:z,staticRenderFns:G},Z=K,tt=a("VU/8"),et=o,at=tt(Q,Z,!1,et,null,null),st=at.exports,rt={name:"Calendar",data:function(){return{currentYear:"2017",currentMonth:"12",currentDate:"4",currentDay:"一"}},beforeCreate:function(){"true"!=window.sessionStorage.getItem("logged-in")&&this.$router.replace("/login")},components:{"nav-bar":W},watch:{currentMonth:function(t){t<1?(this.currentMonth=12,this.currentYear-=1):t>12&&(this.currentMonth=1,this.currentYear+=1)},currentYear:function(t){var e=(new Date).getFullYear();t>e&&(this.currentYear=e)}}},nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"calendar"}},[a("nav-bar",{attrs:{currentPage:"calendar"}}),t._v(" "),a("div",{attrs:{id:"calendar-container"}},[a("div",{staticClass:"calendar-top"},[a("div",{staticClass:"top-item selected-year"},[a("i",{staticClass:"btn fa fa-caret-left fa-fw",on:{click:function(e){e.preventDefault(),t.currentYear-=1}}}),t._v(" "),a("span",{staticClass:"text"},[t._v(t._s(t.currentYear+"年"))]),t._v(" "),a("i",{staticClass:"btn fa fa-caret-right fa-fw",on:{click:function(e){t.currentYear+=1}}})]),t._v(" "),a("div",{staticClass:"top-item selected-day"},[a("span",{staticClass:"text"},[t._v(t._s(t.currentDate+"日/周"+t.currentDay))])]),t._v(" "),a("div",{staticClass:"top-item selected-month"},[a("i",{staticClass:"btn fa fa-caret-left fa-fw",on:{click:function(e){t.currentMonth-=1}}}),t._v(" "),a("span",{staticClass:"text"},[t._v(t._s(t.currentMonth+"月"))]),t._v(" "),a("i",{staticClass:"btn fa fa-caret-right fa-fw",on:{click:function(e){t.currentMonth+=1}}})])])])],1)},it=[],ot={render:nt,staticRenderFns:it},dt=ot,ut=a("VU/8"),ct=d,lt=ut(rt,dt,!1,ct,null,null),pt=lt.exports,ft={name:"Overview",data:function(){return{}},beforeCreate:function(){"true"!=window.sessionStorage.getItem("logged-in")&&this.$router.replace("/login")},components:{"nav-bar":W}},vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"overview"}},[a("nav-bar",{attrs:{currentPage:"overview"}}),t._v(" "),a("div",{attrs:{id:"overview-container"}})],1)},mt=[],gt={render:vt,staticRenderFns:mt},wt=gt,ht=a("VU/8"),yt=u,_t=ht(ft,wt,!1,yt,null,null),Ct=_t.exports;c.a.use(_.a);var kt=new _.a({routes:[{path:"/login",name:"Login",component:A,alias:"/"},{path:"/register",name:"Register",component:L},{path:"/diary",name:"Diary",component:st},{path:"/calendar",name:"Calendar",component:pt},{path:"/overview",name:"Overview",component:Ct}]});a("FXkv"),a("iGtm");c.a.config.productionTip=!1;new c.a({el:"#app",router:kt,template:"<App/>",components:{App:y}})},Q4uO:function(t,e){},WIEj:function(t,e){},XBpM:function(t,e){},cEaC:function(t,e,a){t.exports=a.p+"static/fonts/fontawesome-webfont.674f50d.eot"},cmUn:function(t,e,a){t.exports=a.p+"static/fonts/fontawesome-webfont.674f50d.eot"},jNsU:function(t,e,a){t.exports=a.p+"static/fonts/fontawesome-webfont.fee66e7.woff"},lnU4:function(t,e){},"of+2":function(t,e,a){t.exports=a.p+"static/fonts/fontawesome-webfont.af7ae50.woff2"},"ulV+":function(t,e){}},["NHnr"]);